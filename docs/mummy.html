<!DOCTYPE html>

<html>
<head>
  <title>Mummy.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1 id="mummy-js">Mummy.js</h1>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h2 id="-">木乃伊</h2>

            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <pre><code>mummy.js反其道而行，扩展「污染」原生的JS对象。
以实现更简洁，更直观的操作
没必要像主流JS框架那样，去封装一层，比如$(dom)
!<span class="hljs-attribute">CopyRight</span>: binnng
Licensed <span class="hljs-attribute">under</span>: MIT
<span class="hljs-attribute">https</span>:<span class="hljs-regexp">//gi</span>thub.com/binnng/mummy.js
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>
AUTHOR = <span class="hljs-string">"binnng"</span>
VERSION = <span class="hljs-string">"0.0.1"</span>
NAME = <span class="hljs-string">"mummy"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <h2 id="core">Core</h2>

            </div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-built_in">window</span> = @
<span class="hljs-built_in">document</span> = <span class="hljs-built_in">window</span>.<span class="hljs-built_in">document</span>

TRIGGER = <span class="hljs-string">"trigger"</span>
<span class="hljs-function">
<span class="hljs-title">noop</span> = -&gt;</span>


querySelectorAll = <span class="hljs-built_in">document</span>.querySelectorAll.bind <span class="hljs-built_in">document</span>
createElement = <span class="hljs-built_in">document</span>.createElement.bind <span class="hljs-built_in">document</span></pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>如果不支持<code>Node</code>,<code>NodeList</code>
写个构造函数</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Node = <span class="hljs-built_in">window</span>.Node <span class="hljs-keyword">or</span> <span class="hljs-class"><span class="hljs-keyword">class</span> </span>
	<span class="hljs-attribute">constructor</span>: <span class="hljs-function">-&gt;</span>

NodeList = <span class="hljs-built_in">window</span>.NodeList <span class="hljs-keyword">or</span> <span class="hljs-class"><span class="hljs-keyword">class</span></span>
	<span class="hljs-attribute">constructor</span>: <span class="hljs-function">-&gt;</span></pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>统一原型</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>[
  Node
  NodeList
].forEach (v) -&gt;
  <span class="hljs-attribute">v</span>::mummy = NAME

<span class="hljs-attribute">NodeList</span>::forEach = [].forEach</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <h2 id="event">Event</h2>

            </div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>添加自定义事件支持</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-built_in">window</span>[TRIGGER] = <span class="hljs-attribute">Node</span>::[TRIGGER] = <span class="hljs-function"><span class="hljs-params">(type, data)</span> -&gt;</span>
  
  event = <span class="hljs-built_in">document</span>.createEvent(<span class="hljs-string">"HTMLEvents"</span>)
  event.initEvent type, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>
  event.data = data <span class="hljs-keyword">or</span> {}
  event.eventName = type
  event.target = @
  
  <span class="hljs-property">@dispatchEvent</span> event
  
  @

<span class="hljs-attribute">NodeList</span>::[TRIGGER] = <span class="hljs-function"><span class="hljs-params">(event)</span> -&gt;</span>
  <span class="hljs-property">@forEach</span> (el) -&gt;
    el[TRIGGER] event

  @</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>为node对象添加on方法 </p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-built_in">window</span>.<span class="hljs-literal">on</span> = <span class="hljs-attribute">Node</span>::<span class="hljs-literal">on</span> = <span class="hljs-function"><span class="hljs-params">(event, fn)</span> -&gt;</span>
  <span class="hljs-property">@addEventListener</span> event, fn, <span class="hljs-literal">false</span>
  
  @</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>nodeList遍历添加</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-attribute">NodeList</span>::<span class="hljs-literal">on</span> = <span class="hljs-function"><span class="hljs-params">(event, fn)</span> -&gt;</span>
  <span class="hljs-property">@forEach</span> (el) -&gt;
    el.<span class="hljs-literal">on</span> event, fn

  @</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <h2 id="dom">Dom</h2>

            </div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>选择器，DOM操作</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function">
<span class="hljs-title">dom</span> = <span class="hljs-params">(s)</span> -&gt;</span>
  
  r = querySelectorAll(s <span class="hljs-keyword">or</span> <span class="hljs-string">"body"</span>)
  length = r.length</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>单个元素直接返回
多个元素返回nodeList</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  (<span class="hljs-keyword">if</span> length <span class="hljs-keyword">is</span> <span class="hljs-number">1</span> <span class="hljs-keyword">then</span> r[<span class="hljs-number">0</span>] <span class="hljs-keyword">else</span> r)</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>封装node style属性</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-attribute">Node</span>::css = <span class="hljs-function"><span class="hljs-params">(k, v)</span> -&gt;</span>
  self = @
  (<span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> k <span class="hljs-keyword">isnt</span> <span class="hljs-string">"object"</span> <span class="hljs-keyword">then</span> <span class="hljs-property">@style</span>[k] = v <span class="hljs-keyword">else</span> (<span class="hljs-function"><span class="hljs-params">(k)</span> -&gt;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">of</span> k
      self.css i, k[i]
  )(k))
  @</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>同理递归实现</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-attribute">NodeList</span>::css = <span class="hljs-function"><span class="hljs-params">(k, v)</span> -&gt;</span>
  <span class="hljs-property">@forEach</span> (el) -&gt;
    el.css k, v

  @</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <h2 id="entry">Entry</h2>

            </div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>创建实例 
s 为选择器元素</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>entry = dom

entry.author = AUTHOR
entry.version = VERSION</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>模块化</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> exports <span class="hljs-keyword">isnt</span> <span class="hljs-string">"undefined"</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">module</span>.exports
  <span class="hljs-built_in">module</span>.exports = entry
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> define <span class="hljs-keyword">is</span> <span class="hljs-string">"function"</span> <span class="hljs-keyword">and</span> define.cmd
  define <span class="hljs-string">"mummy"</span>, <span class="hljs-function"><span class="hljs-params">(<span class="hljs-built_in">require</span>, exports, <span class="hljs-built_in">module</span>)</span> -&gt;</span>
    <span class="hljs-built_in">module</span>.exports = exports = entry
<span class="hljs-keyword">else</span>
  <span class="hljs-built_in">window</span>.$ = entry</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
